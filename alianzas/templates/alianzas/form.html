{% extends "form.html" %}

{% block title %}{% if alianza %}Editar Alianza{% else %}Nueva Alianza{% endif %}{% endblock %}

{% block back_link %}
  <section class="filter-container">
    <a href="{{ back_url|default_if_none:'' }}" class="btn-filter">Volver</a>
  </section>
{% endblock %}

{% block form_fields %}
  {% if alianza %}
  <div class="form-meta">Fecha de registro: {{ alianza.fecha_registro|date:"d/m/Y H:i"|default_if_none:"" }}</div>
  {% endif %}
  <input type="hidden" name="next" value="{{ back_url|default_if_none:'' }}">
  <div class="form-grid">
    <div class="form-col">
      <label for="{{ form.nombre.id_for_label }}">Nombre</label>
      {{ form.nombre }}
      <label for="{{ form.correo_electronico.id_for_label }}">Correo electr&oacute;nico</label>
      {{ form.correo_electronico }}
    </div>
  </div>
  {% if alianza %}
    <hr class="form-sep">
    <div class="form-meta">Clientes</div>
    {% if clientes_rel %}
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>Cliente</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for c in clientes_rel %}
              <tr>
                <td>{{ c.razon_social|default_if_none:"" }}</td>
                <td>
                  <a class="btn-detalle" href="{% url 'clientes_edit' c.id %}?next={{ request.get_full_path|urlencode }}">Editar</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="form-meta">Sin clientes</div>
    {% endif %}
  {% endif %}
{% endblock %}

{% block extra_actions %}
  {% if alianza %}
    <button type="submit"
            class="btn-delete"
            formaction="{% url 'alianzas_delete' alianza.id %}"
            formmethod="post"
            onclick="return confirm('Â¿Eliminar esta alianza?');">
      Eliminar
    </button>
  {% endif %}
{% endblock %}
